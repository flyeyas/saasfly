<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>广告编辑 - 后台管理系统</title>
    <link rel="stylesheet" href="../assets/css/global.css">
    <link rel="stylesheet" href="../assets/css/responsive.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Orbitron:wght@400;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* 后台管理布局 */
        .admin-layout {
            display: flex;
            min-height: 100vh;
            background: var(--gray-50);
        }
        
        .admin-sidebar {
            width: 280px;
            background: white;
            box-shadow: var(--shadow-lg);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 1000;
        }
        
        .admin-main {
            flex: 1;
            margin-left: 280px;
            display: flex;
            flex-direction: column;
        }
        
        .admin-header {
            background: white;
            padding: var(--space-4) var(--space-6);
            box-shadow: var(--shadow-sm);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .admin-content {
            flex: 1;
            padding: var(--space-6);
        }
        
        /* 侧边栏样式 */
        .sidebar-brand {
            padding: var(--space-6);
            border-bottom: 1px solid var(--gray-200);
            text-align: center;
        }
        
        .sidebar-brand-icon {
            font-size: var(--text-2xl);
            color: var(--primary-500);
            margin-bottom: var(--space-2);
        }
        
        .sidebar-brand-text {
            font-family: var(--font-game);
            font-size: var(--text-lg);
            font-weight: var(--font-bold);
            color: var(--gray-900);
        }
        
        .admin-nav {
            padding: var(--space-4) 0;
        }
        
        .nav-section {
            margin-bottom: var(--space-6);
        }
        
        .nav-section-title {
            font-size: var(--text-xs);
            font-weight: var(--font-semibold);
            color: var(--gray-500);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            padding: 0 var(--space-6) var(--space-2);
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            padding: var(--space-3) var(--space-6);
            color: var(--gray-700);
            text-decoration: none;
            transition: all var(--duration-fast) var(--ease-out);
            border-left: 3px solid transparent;
        }
        
        .nav-item:hover {
            background: var(--primary-50);
            color: var(--primary-600);
            border-left-color: var(--primary-200);
        }
        
        .nav-item.active {
            background: var(--primary-100);
            color: var(--primary-700);
            border-left-color: var(--primary-500);
            font-weight: var(--font-medium);
        }
        
        .nav-item-icon {
            width: 20px;
            margin-right: var(--space-3);
            text-align: center;
        }
        
        .user-info {
            padding: var(--space-4) var(--space-6);
            border-top: 1px solid var(--gray-200);
            margin-top: auto;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-full);
            background: var(--primary-100);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-600);
            font-weight: var(--font-bold);
            margin-bottom: var(--space-2);
        }
        
        .user-name {
            font-weight: var(--font-medium);
            color: var(--gray-900);
            margin-bottom: var(--space-1);
        }
        
        .user-role {
            font-size: var(--text-sm);
            color: var(--gray-500);
        }
        
        /* 页面头部 */
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-6);
        }
        
        .page-title {
            font-size: var(--text-2xl);
            font-weight: var(--font-bold);
            color: var(--gray-900);
            margin-bottom: var(--space-1);
        }
        
        .page-subtitle {
            color: var(--gray-600);
            font-size: var(--text-base);
        }
        
        .page-actions {
            display: flex;
            gap: var(--space-3);
        }
        
        .breadcrumb {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            margin-bottom: var(--space-4);
            font-size: var(--text-sm);
            color: var(--gray-600);
        }
        
        .breadcrumb a {
            color: var(--primary-600);
            text-decoration: none;
        }
        
        .breadcrumb a:hover {
            text-decoration: underline;
        }
        
        .breadcrumb-separator {
            color: var(--gray-400);
        }
        
        /* 表单样式 */
        .form-container {
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            overflow: hidden;
        }
        
        .form-header {
            padding: var(--space-6);
            border-bottom: 1px solid var(--gray-200);
            background: var(--gray-50);
        }
        
        .form-title {
            font-size: var(--text-xl);
            font-weight: var(--font-semibold);
            color: var(--gray-900);
            margin-bottom: var(--space-1);
        }
        
        .form-subtitle {
            color: var(--gray-600);
            font-size: var(--text-sm);
        }
        
        .form-content {
            padding: var(--space-6);
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: var(--space-8);
        }
        
        .form-section {
            margin-bottom: var(--space-8);
        }
        
        .section-title {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--gray-900);
            margin-bottom: var(--space-4);
            padding-bottom: var(--space-2);
            border-bottom: 2px solid var(--primary-100);
        }
        
        .form-group {
            margin-bottom: var(--space-6);
        }
        
        .form-label {
            display: block;
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--gray-700);
            margin-bottom: var(--space-2);
        }
        
        .form-label.required::after {
            content: ' *';
            color: var(--error-500);
        }
        
        .form-input {
            width: 100%;
            padding: var(--space-3);
            border: 1px solid var(--gray-300);
            border-radius: var(--radius-md);
            font-size: var(--text-sm);
            transition: all var(--duration-fast) var(--ease-out);
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--primary-500);
            box-shadow: 0 0 0 3px var(--primary-100);
        }
        
        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .form-select {
            width: 100%;
            padding: var(--space-3);
            border: 1px solid var(--gray-300);
            border-radius: var(--radius-md);
            font-size: var(--text-sm);
            background: white;
            cursor: pointer;
        }
        
        .form-help {
            font-size: var(--text-xs);
            color: var(--gray-500);
            margin-top: var(--space-1);
        }
        
        .form-error {
            font-size: var(--text-xs);
            color: var(--error-500);
            margin-top: var(--space-1);
        }
        
        /* 文件上传 */
        .file-upload {
            border: 2px dashed var(--gray-300);
            border-radius: var(--radius-md);
            padding: var(--space-8);
            text-align: center;
            transition: all var(--duration-fast) var(--ease-out);
            cursor: pointer;
        }
        
        .file-upload:hover {
            border-color: var(--primary-400);
            background: var(--primary-50);
        }
        
        .file-upload.dragover {
            border-color: var(--primary-500);
            background: var(--primary-100);
        }
        
        .file-upload-icon {
            font-size: var(--text-3xl);
            color: var(--gray-400);
            margin-bottom: var(--space-4);
        }
        
        .file-upload-text {
            color: var(--gray-600);
            margin-bottom: var(--space-2);
        }
        
        .file-upload-hint {
            font-size: var(--text-xs);
            color: var(--gray-500);
        }
        
        .file-preview {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-3);
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-md);
            background: var(--gray-50);
        }
        
        .file-preview-icon {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-md);
            background: var(--primary-100);
            color: var(--primary-600);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .file-preview-info {
            flex: 1;
        }
        
        .file-preview-name {
            font-weight: var(--font-medium);
            color: var(--gray-900);
            margin-bottom: var(--space-1);
        }
        
        .file-preview-size {
            font-size: var(--text-xs);
            color: var(--gray-500);
        }
        
        .file-preview-remove {
            color: var(--error-500);
            cursor: pointer;
            padding: var(--space-2);
            border-radius: var(--radius-md);
            transition: all var(--duration-fast) var(--ease-out);
        }
        
        .file-preview-remove:hover {
            background: var(--error-50);
        }
        
        /* 开关组件 */
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .switch-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--gray-300);
            transition: var(--duration-fast);
            border-radius: 24px;
        }
        
        .switch-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: var(--duration-fast);
            border-radius: 50%;
        }
        
        .switch input:checked + .switch-slider {
            background-color: var(--primary-500);
        }
        
        .switch input:checked + .switch-slider:before {
            transform: translateX(26px);
        }
        
        /* 复选框组 */
        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: var(--space-3);
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }
        
        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary-500);
        }
        
        .checkbox-item label {
            font-size: var(--text-sm);
            color: var(--gray-700);
            cursor: pointer;
        }
        
        /* 单选框组 */
        .radio-group {
            display: flex;
            flex-direction: column;
            gap: var(--space-3);
        }
        
        .radio-item {
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }
        
        .radio-item input[type="radio"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary-500);
        }
        
        .radio-item label {
            font-size: var(--text-sm);
            color: var(--gray-700);
            cursor: pointer;
        }
        
        /* 侧边栏预览 */
        .preview-section {
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            overflow: hidden;
            margin-bottom: var(--space-6);
        }
        
        .preview-header {
            padding: var(--space-4);
            border-bottom: 1px solid var(--gray-200);
            background: var(--gray-50);
        }
        
        .preview-title {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--gray-900);
        }
        
        .preview-content {
            padding: var(--space-4);
        }
        
        .ad-preview {
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-md);
            padding: var(--space-4);
            background: var(--gray-50);
            text-align: center;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray-500);
        }
        
        .ad-preview.has-content {
            background: white;
            color: var(--gray-900);
        }
        
        .ad-preview img {
            max-width: 100%;
            height: auto;
            border-radius: var(--radius-md);
        }
        
        /* 按钮样式 */
        .btn-primary {
            background: var(--primary-500);
            color: white;
            border: none;
            padding: var(--space-3) var(--space-6);
            border-radius: var(--radius-md);
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            cursor: pointer;
            transition: all var(--duration-fast) var(--ease-out);
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
        }
        
        .btn-primary:hover {
            background: var(--primary-600);
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background: white;
            color: var(--gray-700);
            border: 1px solid var(--gray-300);
            padding: var(--space-3) var(--space-6);
            border-radius: var(--radius-md);
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            cursor: pointer;
            transition: all var(--duration-fast) var(--ease-out);
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
        }
        
        .btn-secondary:hover {
            background: var(--gray-50);
            border-color: var(--gray-400);
        }
        
        .btn-danger {
            background: var(--error-500);
            color: white;
            border: none;
            padding: var(--space-3) var(--space-6);
            border-radius: var(--radius-md);
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            cursor: pointer;
            transition: all var(--duration-fast) var(--ease-out);
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
        }
        
        .btn-danger:hover {
            background: var(--error-600);
        }
        
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: var(--space-3);
            padding: var(--space-6);
            border-top: 1px solid var(--gray-200);
            background: var(--gray-50);
        }
        
        /* 响应式设计 */
        @media (max-width: 1024px) {
            .admin-sidebar {
                transform: translateX(-100%);
                transition: transform var(--duration-normal) var(--ease-out);
            }
            
            .admin-sidebar.open {
                transform: translateX(0);
            }
            
            .admin-main {
                margin-left: 0;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .page-header {
                flex-direction: column;
                align-items: flex-start;
                gap: var(--space-4);
            }
            
            .form-actions {
                flex-direction: column;
            }
            
            .form-actions button {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="admin-layout">
        <!-- 侧边栏 -->
        <aside class="admin-sidebar">
            <div class="sidebar-brand">
                <div class="sidebar-brand-icon">
                    <i class="fas fa-gamepad"></i>
                </div>
                <div class="sidebar-brand-text">GameHub Admin</div>
            </div>
            
            <nav class="admin-nav">
                <div class="nav-section">
                    <div class="nav-section-title">主要功能</div>
                    <a href="admin.html" class="nav-item">
                        <i class="fas fa-tachometer-alt nav-item-icon"></i>
                        <span>仪表盘</span>
                    </a>
                    <a href="admin-games.html" class="nav-item">
                        <i class="fas fa-gamepad nav-item-icon"></i>
                        <span>游戏管理</span>
                    </a>
                    <a href="admin-users.html" class="nav-item">
                        <i class="fas fa-users nav-item-icon"></i>
                        <span>用户管理</span>
                    </a>
                    <a href="admin-categories.html" class="nav-item">
                        <i class="fas fa-folder nav-item-icon"></i>
                        <span>分类管理</span>
                    </a>
                    <a href="admin-tags.html" class="nav-item">
                        <i class="fas fa-tags nav-item-icon"></i>
                        <span>标签管理</span>
                    </a>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">营销推广</div>
                    <a href="admin-ads.html" class="nav-item active">
                        <i class="fas fa-bullhorn nav-item-icon"></i>
                        <span>广告管理</span>
                    </a>
                    <a href="admin-analytics.html" class="nav-item">
                        <i class="fas fa-chart-bar nav-item-icon"></i>
                        <span>数据分析</span>
                    </a>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">系统设置</div>
                    <a href="admin-config.html" class="nav-item">
                        <i class="fas fa-cog nav-item-icon"></i>
                        <span>系统配置</span>
                    </a>
                    <a href="admin-smtp.html" class="nav-item">
                        <i class="fas fa-envelope nav-item-icon"></i>
                        <span>邮箱配置</span>
                    </a>
                </div>
            </nav>
            
            <div class="user-info">
                <div class="user-avatar">A</div>
                <div class="user-name">管理员</div>
                <div class="user-role">系统管理员</div>
            </div>
        </aside>
        
        <!-- 主要内容区域 -->
        <main class="admin-main">
            <header class="admin-header">
                <button class="btn-secondary mobile-menu-btn" style="display: none;">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="header-actions">
                    <button class="btn-secondary">
                        <i class="fas fa-bell"></i>
                    </button>
                    <button class="btn-secondary">
                        <i class="fas fa-user-circle"></i>
                    </button>
                </div>
            </header>
            
            <div class="admin-content">
                <!-- 面包屑导航 -->
                <nav class="breadcrumb">
                    <a href="admin.html">仪表盘</a>
                    <span class="breadcrumb-separator">/</span>
                    <a href="admin-ads.html">广告管理</a>
                    <span class="breadcrumb-separator">/</span>
                    <span id="breadcrumb-action">新建广告</span>
                </nav>
                
                <!-- 页面标题 -->
                <div class="page-header">
                    <div>
                        <h1 class="page-title" id="page-title">新建广告</h1>
                        <p class="page-subtitle">创建和配置网站广告，优化收益和用户体验</p>
                    </div>
                    <div class="page-actions">
                        <button class="btn-secondary" onclick="previewAd()">
                            <i class="fas fa-eye"></i>
                            <span>预览</span>
                        </button>
                        <button class="btn-secondary" onclick="saveDraft()">
                            <i class="fas fa-save"></i>
                            <span>保存草稿</span>
                        </button>
                    </div>
                </div>
                
                <!-- 表单容器 -->
                <div class="form-container">
                    <div class="form-header">
                        <h2 class="form-title">广告信息</h2>
                        <p class="form-subtitle">填写广告的基本信息和配置参数</p>
                    </div>
                    
                    <form id="adForm" class="form-content">
                        <div class="form-grid">
                            <!-- 主要表单区域 -->
                            <div class="main-form">
                                <!-- 基本信息 -->
                                <div class="form-section">
                                    <h3 class="section-title">基本信息</h3>
                                    
                                    <div class="form-group">
                                        <label for="adName" class="form-label required">广告名称</label>
                                        <input type="text" id="adName" name="adName" class="form-input" placeholder="请输入广告名称" required>
                                        <div class="form-help">用于内部管理识别的广告名称</div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="adType" class="form-label required">广告类型</label>
                                        <select id="adType" name="adType" class="form-select" required onchange="updateAdTypeFields()">
                                            <option value="">请选择广告类型</option>
                                            <option value="banner">横幅广告</option>
                                            <option value="popup">弹窗广告</option>
                                            <option value="native">原生广告</option>
                                            <option value="video">视频广告</option>
                                            <option value="adsense">Google AdSense</option>
                                        </select>
                                        <div class="form-help">选择适合的广告展示类型</div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="adPosition" class="form-label required">广告位置</label>
                                        <select id="adPosition" name="adPosition" class="form-select" required>
                                            <option value="">请选择广告位置</option>
                                            <option value="header">页面顶部</option>
                                            <option value="sidebar">侧边栏</option>
                                            <option value="content">内容区域</option>
                                            <option value="footer">页面底部</option>
                                            <option value="popup">弹窗</option>
                                            <option value="mobile-bottom">移动端底部</option>
                                        </select>
                                        <div class="form-help">选择广告在网站中的展示位置</div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="adDescription" class="form-label">广告描述</label>
                                        <textarea id="adDescription" name="adDescription" class="form-input form-textarea" placeholder="请输入广告描述（可选）"></textarea>
                                        <div class="form-help">简要描述广告内容和目的</div>
                                    </div>
                                </div>
                                
                                <!-- 广告内容 -->
                                <div class="form-section" id="contentSection">
                                    <h3 class="section-title">广告内容</h3>
                                    
                                    <!-- 自定义广告内容 -->
                                    <div id="customAdContent" style="display: none;">
                                        <div class="form-group">
                                            <label for="adTitle" class="form-label">广告标题</label>
                                            <input type="text" id="adTitle" name="adTitle" class="form-input" placeholder="请输入广告标题">
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="adImage" class="form-label">广告图片</label>
                                            <div class="file-upload" onclick="document.getElementById('imageInput').click()">
                                                <div class="file-upload-icon">
                                                    <i class="fas fa-cloud-upload-alt"></i>
                                                </div>
                                                <div class="file-upload-text">点击上传图片或拖拽文件到此处</div>
                                                <div class="file-upload-hint">支持 JPG、PNG、GIF 格式，最大 5MB</div>
                                            </div>
                                            <input type="file" id="imageInput" accept="image/*" style="display: none;" onchange="handleImageUpload(this)">
                                            <div id="imagePreview" style="display: none;"></div>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="adUrl" class="form-label">链接地址</label>
                                            <input type="url" id="adUrl" name="adUrl" class="form-input" placeholder="https://example.com">
                                            <div class="form-help">用户点击广告后跳转的链接地址</div>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="adText" class="form-label">广告文案</label>
                                            <textarea id="adText" name="adText" class="form-input form-textarea" placeholder="请输入广告文案内容"></textarea>
                                        </div>
                                    </div>
                                    
                                    <!-- AdSense 代码 -->
                                    <div id="adsenseContent" style="display: none;">
                                        <div class="form-group">
                                            <label for="adsenseCode" class="form-label required">AdSense 代码</label>
                                            <textarea id="adsenseCode" name="adsenseCode" class="form-input form-textarea" placeholder="请粘贴 Google AdSense 广告代码" style="min-height: 200px; font-family: monospace;"></textarea>
                                            <div class="form-help">从 Google AdSense 后台复制的广告代码</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- 展示设置 -->
                                <div class="form-section">
                                    <h3 class="section-title">展示设置</h3>
                                    
                                    <div class="form-group">
                                        <label for="adStatus" class="form-label">广告状态</label>
                                        <div class="radio-group">
                                            <div class="radio-item">
                                                <input type="radio" id="statusActive" name="adStatus" value="active" checked>
                                                <label for="statusActive">立即启用</label>
                                            </div>
                                            <div class="radio-item">
                                                <input type="radio" id="statusInactive" name="adStatus" value="inactive">
                                                <label for="statusInactive">暂不启用</label>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="adPriority" class="form-label">显示优先级</label>
                                        <select id="adPriority" name="adPriority" class="form-select">
                                            <option value="low">低</option>
                                            <option value="medium" selected>中</option>
                                            <option value="high">高</option>
                                        </select>
                                        <div class="form-help">优先级高的广告会优先展示</div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">展示设备</label>
                                        <div class="checkbox-group">
                                            <div class="checkbox-item">
                                                <input type="checkbox" id="deviceDesktop" name="devices" value="desktop" checked>
                                                <label for="deviceDesktop">桌面端</label>
                                            </div>
                                            <div class="checkbox-item">
                                                <input type="checkbox" id="deviceMobile" name="devices" value="mobile" checked>
                                                <label for="deviceMobile">移动端</label>
                                            </div>
                                            <div class="checkbox-item">
                                                <input type="checkbox" id="deviceTablet" name="devices" value="tablet" checked>
                                                <label for="deviceTablet">平板端</label>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="startDate" class="form-label">开始时间</label>
                                        <input type="datetime-local" id="startDate" name="startDate" class="form-input">
                                        <div class="form-help">留空表示立即开始</div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="endDate" class="form-label">结束时间</label>
                                        <input type="datetime-local" id="endDate" name="endDate" class="form-input">
                                        <div class="form-help">留空表示永不结束</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 侧边栏预览区域 -->
                            <div class="sidebar-form">
                                <!-- 广告预览 -->
                                <div class="preview-section">
                                    <div class="preview-header">
                                        <h3 class="preview-title">广告预览</h3>
                                    </div>
                                    <div class="preview-content">
                                        <div id="adPreview" class="ad-preview">
                                            <div>
                                                <i class="fas fa-eye" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                                                <div>广告预览将在这里显示</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- 帮助信息 -->
                                <div class="preview-section">
                                    <div class="preview-header">
                                        <h3 class="preview-title">帮助信息</h3>
                                    </div>
                                    <div class="preview-content">
                                        <div style="font-size: var(--text-sm); color: var(--gray-600); line-height: 1.6;">
                                            <h4 style="color: var(--gray-900); margin-bottom: var(--space-2);">广告类型说明：</h4>
                                            <ul style="margin-left: var(--space-4); margin-bottom: var(--space-4);">
                                                <li><strong>横幅广告：</strong>适合页面顶部、底部展示</li>
                                                <li><strong>弹窗广告：</strong>以弹窗形式展示，注意用户体验</li>
                                                <li><strong>原生广告：</strong>融入内容的自然广告</li>
                                                <li><strong>视频广告：</strong>视频形式的广告内容</li>
                                                <li><strong>AdSense：</strong>Google 广告联盟</li>
                                            </ul>
                                            
                                            <h4 style="color: var(--gray-900); margin-bottom: var(--space-2);">优化建议：</h4>
                                            <ul style="margin-left: var(--space-4);">
                                                <li>选择合适的广告位置</li>
                                                <li>保持广告与内容的平衡</li>
                                                <li>定期查看广告效果数据</li>
                                                <li>根据用户反馈调整策略</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                    
                    <!-- 表单操作按钮 -->
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="cancelForm()">
                            <i class="fas fa-times"></i>
                            <span>取消</span>
                        </button>
                        <button type="button" class="btn-secondary" onclick="saveDraft()">
                            <i class="fas fa-save"></i>
                            <span>保存草稿</span>
                        </button>
                        <button type="submit" class="btn-primary" onclick="submitForm(event)">
                            <i class="fas fa-check"></i>
                            <span id="submitText">创建广告</span>
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // 页面初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 检查是否为编辑模式
            const urlParams = new URLSearchParams(window.location.search);
            const adId = urlParams.get('id');
            
            if (adId) {
                // 编辑模式
                document.getElementById('page-title').textContent = '编辑广告';
                document.getElementById('breadcrumb-action').textContent = '编辑广告';
                document.getElementById('submitText').textContent = '更新广告';
                loadAdData(adId);
            }
            
            // 移动端菜单
            setupMobileMenu();
            
            // 表单验证
            setupFormValidation();
            
            // 实时预览
            setupLivePreview();
        });
        
        // 移动端菜单设置
        function setupMobileMenu() {
            const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
            const sidebar = document.querySelector('.admin-sidebar');
            
            function checkScreenSize() {
                if (window.innerWidth <= 1024) {
                    mobileMenuBtn.style.display = 'inline-flex';
                } else {
                    mobileMenuBtn.style.display = 'none';
                    sidebar.classList.remove('open');
                }
            }
            
            checkScreenSize();
            window.addEventListener('resize', checkScreenSize);
            
            mobileMenuBtn.addEventListener('click', function() {
                sidebar.classList.toggle('open');
            });
            
            document.querySelector('.admin-main').addEventListener('click', function() {
                if (window.innerWidth <= 1024) {
                    sidebar.classList.remove('open');
                }
            });
        }
        
        // 广告类型字段更新
        function updateAdTypeFields() {
            const adType = document.getElementById('adType').value;
            const customContent = document.getElementById('customAdContent');
            const adsenseContent = document.getElementById('adsenseContent');
            
            if (adType === 'adsense') {
                customContent.style.display = 'none';
                adsenseContent.style.display = 'block';
            } else if (adType) {
                customContent.style.display = 'block';
                adsenseContent.style.display = 'none';
            } else {
                customContent.style.display = 'none';
                adsenseContent.style.display = 'none';
            }
            
            updatePreview();
        }
        
        // 图片上传处理
        function handleImageUpload(input) {
            const file = input.files[0];
            if (file) {
                // 验证文件类型
                if (!file.type.startsWith('image/')) {
                    alert('请选择图片文件');
                    return;
                }
                
                // 验证文件大小 (5MB)
                if (file.size > 5 * 1024 * 1024) {
                    alert('图片大小不能超过 5MB');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('imagePreview');
                    preview.innerHTML = `
                        <div class="file-preview">
                            <div class="file-preview-icon">
                                <i class="fas fa-image"></i>
                            </div>
                            <div class="file-preview-info">
                                <div class="file-preview-name">${file.name}</div>
                                <div class="file-preview-size">${(file.size / 1024).toFixed(1)} KB</div>
                            </div>
                            <div class="file-preview-remove" onclick="removeImage()">
                                <i class="fas fa-times"></i>
                            </div>
                        </div>
                    `;
                    preview.style.display = 'block';
                    updatePreview();
                };
                reader.readAsDataURL(file);
            }
        }
        
        // 移除图片
        function removeImage() {
            document.getElementById('imageInput').value = '';
            document.getElementById('imagePreview').style.display = 'none';
            updatePreview();
        }
        
        // 实时预览设置
        function setupLivePreview() {
            const inputs = document.querySelectorAll('#adForm input, #adForm select, #adForm textarea');
            inputs.forEach(input => {
                input.addEventListener('input', updatePreview);
                input.addEventListener('change', updatePreview);
            });
        }
        
        // 更新预览
        function updatePreview() {
            const preview = document.getElementById('adPreview');
            const adType = document.getElementById('adType').value;
            const adTitle = document.getElementById('adTitle').value;
            const adText = document.getElementById('adText').value;
            const imageInput = document.getElementById('imageInput');
            const adsenseCode = document.getElementById('adsenseCode').value;
            
            if (!adType) {
                preview.innerHTML = `
                    <div>
                        <i class="fas fa-eye" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                        <div>请先选择广告类型</div>
                    </div>
                `;
                preview.className = 'ad-preview';
                return;
            }
            
            preview.className = 'ad-preview has-content';
            
            if (adType === 'adsense') {
                if (adsenseCode) {
                    preview.innerHTML = `
                        <div style="padding: 1rem; border: 2px dashed #ccc; background: #f9f9f9;">
                            <div style="text-align: center; color: #666; margin-bottom: 0.5rem;">
                                <i class="fab fa-google"></i> Google AdSense
                            </div>
                            <div style="font-size: 0.75rem; color: #999;">广告代码预览</div>
                        </div>
                    `;
                } else {
                    preview.innerHTML = `
                        <div>
                            <i class="fab fa-google" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                            <div>请输入 AdSense 代码</div>
                        </div>
                    `;
                }
            } else {
                let previewContent = '';
                
                if (imageInput.files && imageInput.files[0]) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        let content = `<img src="${e.target.result}" style="max-width: 100%; height: auto; margin-bottom: 1rem;">`;
                        if (adTitle) content += `<div style="font-weight: bold; margin-bottom: 0.5rem;">${adTitle}</div>`;
                        if (adText) content += `<div style="font-size: 0.875rem; color: #666;">${adText}</div>`;
                        preview.innerHTML = content;
                    };
                    reader.readAsDataURL(imageInput.files[0]);
                } else {
                    if (adTitle) previewContent += `<div style="font-weight: bold; margin-bottom: 0.5rem;">${adTitle}</div>`;
                    if (adText) previewContent += `<div style="font-size: 0.875rem; color: #666; margin-bottom: 1rem;">${adText}</div>`;
                    
                    if (!previewContent) {
                        previewContent = `
                            <div>
                                <i class="fas fa-image" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                                <div>请添加广告内容</div>
                            </div>
                        `;
                    }
                    
                    preview.innerHTML = previewContent;
                }
            }
        }
        
        // 表单验证设置
        function setupFormValidation() {
            const form = document.getElementById('adForm');
            const inputs = form.querySelectorAll('input[required], select[required], textarea[required]');
            
            inputs.forEach(input => {
                input.addEventListener('blur', function() {
                    validateField(this);
                });
                
                input.addEventListener('input', function() {
                    clearFieldError(this);
                });
            });
        }
        
        // 验证单个字段
        function validateField(field) {
            const value = field.value.trim();
            const fieldGroup = field.closest('.form-group');
            
            // 清除之前的错误
            clearFieldError(field);
            
            if (field.hasAttribute('required') && !value) {
                showFieldError(field, '此字段为必填项');
                return false;
            }
            
            // URL 验证
            if (field.type === 'url' && value && !isValidUrl(value)) {
                showFieldError(field, '请输入有效的URL地址');
                return false;
            }
            
            return true;
        }
        
        // 显示字段错误
        function showFieldError(field, message) {
            const fieldGroup = field.closest('.form-group');
            const existingError = fieldGroup.querySelector('.form-error');
            
            if (!existingError) {
                const errorDiv = document.createElement('div');
                errorDiv.className = 'form-error';
                errorDiv.textContent = message;
                fieldGroup.appendChild(errorDiv);
            }
            
            field.style.borderColor = 'var(--error-500)';
        }
        
        // 清除字段错误
        function clearFieldError(field) {
            const fieldGroup = field.closest('.form-group');
            const errorDiv = fieldGroup.querySelector('.form-error');
            
            if (errorDiv) {
                errorDiv.remove();
            }
            
            field.style.borderColor = '';
        }
        
        // URL 验证
        function isValidUrl(string) {
            try {
                new URL(string);
                return true;
            } catch (_) {
                return false;
            }
        }
        
        // 加载广告数据（编辑模式）
        function loadAdData(adId) {
            // 模拟加载数据
            const mockData = {
                adName: '首页横幅广告',
                adType: 'banner',
                adPosition: 'header',
                adDescription: '首页顶部横幅广告位',
                adTitle: '精彩游戏等你来玩',
                adText: '发现最新最热门的HTML5游戏',
                adUrl: 'https://example.com',
                adStatus: 'active',
                adPriority: 'high'
            };
            
            // 填充表单数据
            Object.keys(mockData).forEach(key => {
                const field = document.getElementById(key);
                if (field) {
                    if (field.type === 'radio') {
                        const radio = document.querySelector(`input[name="${key}"][value="${mockData[key]}"]`);
                        if (radio) radio.checked = true;
                    } else {
                        field.value = mockData[key];
                    }
                }
            });
            
            updateAdTypeFields();
        }
        
        // 预览广告
        function previewAd() {
            const adType = document.getElementById('adType').value;
            if (!adType) {
                alert('请先选择广告类型');
                return;
            }
            
            // 在新窗口中打开预览
            const previewWindow = window.open('', '_blank', 'width=800,height=600');
            const previewContent = document.getElementById('adPreview').innerHTML;
            
            previewWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>广告预览</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
                        .preview-container { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
                        .preview-title { margin-bottom: 20px; color: #333; }
                    </style>
                </head>
                <body>
                    <div class="preview-container">
                        <h2 class="preview-title">广告预览</h2>
                        ${previewContent}
                    </div>
                </body>
                </html>
            `);
        }
        
        // 保存草稿
        function saveDraft() {
            const formData = new FormData(document.getElementById('adForm'));
            
            // 模拟保存草稿
            alert('草稿保存成功！\n\n在实际应用中，这里会将表单数据保存到服务器作为草稿。');
        }
        
        // 提交表单
        function submitForm(event) {
            event.preventDefault();
            
            const form = document.getElementById('adForm');
            const formData = new FormData(form);
            
            // 验证必填字段
            const requiredFields = form.querySelectorAll('input[required], select[required], textarea[required]');
            let isValid = true;
            
            requiredFields.forEach(field => {
                if (!validateField(field)) {
                    isValid = false;
                }
            });
            
            if (!isValid) {
                alert('请填写所有必填字段');
                return;
            }
            
            // 获取设备选择
            const devices = [];
            document.querySelectorAll('input[name="devices"]:checked').forEach(device => {
                devices.push(device.value);
            });
            
            if (devices.length === 0) {
                alert('请至少选择一个展示设备');
                return;
            }
            
            // 模拟提交
            const submitBtn = event.target;
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> <span>提交中...</span>';
            submitBtn.disabled = true;
            
            setTimeout(() => {
                alert('广告创建成功！\n\n在实际应用中，这里会将数据提交到服务器并跳转到广告列表页面。');
                
                // 重置按钮
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
                
                // 跳转到广告列表
                // window.location.href = 'admin-ads.html';
            }, 2000);
        }
        
        // 取消表单
        function cancelForm() {
            if (confirm('确定要取消吗？未保存的更改将丢失。')) {
                window.location.href = 'admin-ads.html';
            }
        }
    </script>
</body>
</html>